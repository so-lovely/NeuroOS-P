# NeuroOS-P: 뉴로모픽 포토닉스를 위한 실시간 운영체제

**NeuroOS-P**는 뉴로모픽 포토닉스(Neuromorphic Photonics) 하드웨어의 독특한 문제를 해결하기 위해 처음부터 설계된 경량의 이벤트 기반 실시간 운영체제(RTOS)입니다. 이 프로젝트는 차세대 하드웨어를 제어하기 위한 표준화된 소프트웨어 기반을 제공하여, 개발자들이 낮은 수준의 복잡성 대신 애플리케이션 개발에 집중할 수 있도록 돕는 것을 목표로 합니다.

이 프로젝트는 현재 초기 개발 단계에 있습니다.

---

## ✨ 핵심 기능

커널은 `rv64gc` 아키텍처를 대상으로 C언어와 RISC-V 어셈블리로 작성되었으며, QEMU `virt` 머신을 주요 개발 환경으로 사용합니다.

- **모놀리식 커널 (Monolithic Kernel):** 모든 핵심 OS 서비스를 포함하는 단일 이미지 커널입니다.
- **선점형 스케줄러 (Preemptive Scheduler):** 태스크 간의 공정한 CPU 시간 분배를 보장하는 간단한 틱(tick) 기반의 라운드-로빈 스케줄러입니다.
- **태스크 관리 (Task Management):** 각자 자신의 컨텍스트와 커널 스택을 가지는 다중 태스크 생성을 지원합니다.
- **프로세스 간 통신 (IPC):** 기본적인 이벤트 시그널링 시스템 (`event_wait`/`event_signal`)을 통해 태스크 간의 조정 및 동기화를 지원합니다.
- **시스템 콜 (System Calls):** 태스크가 커널 서비스를 요청할 수 있는 기본적인 시스템 콜 인터페이스를 제공하며, 시간 기반의 블로킹을 위한 `sleep()`을 포함합니다.
- **메모리 관리 (Memory Management):** 커널 이미지 끝 주소부터 물리 페이지 프레임 할당자를 통해 DRAM을 관리합니다.
- **인터럽트 처리 (Interrupt Handling):** RISC-V CLINT로부터 발생하는 주기적인 타이머 인터럽트를 포함하여, 하드웨어 인터럽트와 예외를 처리하는 기본적인 트랩 핸들러를 구현했습니다.

##  STATUS (현재 상태)

이 프로젝트는 **현재 활발히 개발 중(Work in Progress)**이며, 기능적인 프로토타입 단계로 보아야 합니다. 핵심 스케줄링 및 이벤트 시그널링 시스템은 QEMU 시뮬레이션 환경에서 동작합니다. 이 프로토타입은 향후 실제 하드웨어를 대상으로 하는 개발의 기반이 될 것입니다.

## 🛠️ 시작하기

### 사전 요구사항

RISC-V 크로스 컴파일러 툴체인이 설치되어 있고, 시스템 `PATH`에 등록되어 있어야 합니다. 이 프로젝트는 `riscv64-unknown-elf`를 기준으로 설정되어 있습니다.

- **macOS (Homebrew):**
  ```bash
  brew tap riscv/riscv
  brew install riscv-gnu-toolchain
  ```
- **Linux (Debian/Ubuntu):**
  ```bash
  sudo apt-get install build-essential gcc-riscv64-unknown-elf
  ```

### 빌드 및 실행

이 프로젝트는 표준 `Makefile`을 사용합니다.

1.  **툴체인 설정:**
    - `toolchain.mk.example` 파일이 있다면 `toolchain.mk`로 복사하거나 이름을 변경하세요.
    - `toolchain.mk` 파일을 열어 `TOOLCHAIN_PATH`와 `CROSS_COMPILE` 접두사가 자신의 개발 환경과 일치하는지 확인하세요. 기본값은 macOS의 Homebrew 설치 경로 (`/opt/homebrew/bin/`)를 기준으로 합니다.

2.  **커널 빌드:**
    ```bash
    make
    ```

3.  **QEMU 시뮬레이터에서 실행:**
    ```bash
    make qemu
    ```

4.  **빌드 결과물 삭제:**
    ```bash
    make clean
    ```

## 🏗️ 아키텍처 개요

NeuroOS-P는 간단한 모놀리식 커널을 중심으로 구축되었습니다. 시스템은 어셈블리 진입점(`entry.S`)을 통해 부팅되며, 이 과정에서 머신 모드 트랩 핸들러와 초기 스택을 설정한 후 `kmain` 함수를 호출합니다.

이후 C언어로 작성된 커널이 다음과 같은 핵심 서브시스템들을 초기화합니다:
- **메모리 관리자:** 물리 페이지 프레임을 관리합니다.
- **태스크 관리자:** 태스크의 생명주기를 관리합니다.
- **스케줄러:** 매 시스템 틱마다 `READY` 상태의 태스크들을 순환하며 전환하는 라운드-로빈 알고리즘을 사용합니다.
- **이벤트 시스템:** 태스크가 다른 태스크로부터 오는 신호를 기다리며 대기(block)할 수 있도록 합니다.

현재 모든 태스크는 머신 모드(M-mode)에서 실행됩니다.

## 📁 디렉토리 구조

```
NeuroOS-P/
├── src/                # 소스 코드
│   ├── arch/           # 아키텍처 의존적인 코드 (RISC-V)
│   ├── hal/            # 하드웨어 추상화 계층(HAL) 인터페이스
│   ├── include/        # 사용자에게 노출되는 API 헤더
│   └── kernel/         # 핵심 커널 코드 (스케줄러, 태스크, IPC 등)
├── build/              # 빌드 결과물 (git 추적 안 함)
├── examples/           # 예제 애플리케이션
├── docs/               # 문서
├── libs/               # 외부 라이브러리
├── Makefile            # 메인 Makefile
├── toolchain.mk        # 툴체인 설정
└── linker.ld           # 메모리 레이아웃을 위한 링커 스크립트
```

## 📄 라이선스

이 프로젝트는 **MIT 라이선스**를 따릅니다. 자세한 내용은 `LICENSE` 파일을 참고해주세요. (참고: 현재 `LICENSE` 파일은 비어있으므로, 정식 MIT 라이선스 전문을 채워 넣는 것을 권장합니다.)